//! Trigger CVE-2021-28306 in fltk ≤ 0.15.2 – segmentation fault
//! Run once with the BUGGY crate version, once with the FIXED version.

use fltk::{app::App, enums::LabelType, frame::Frame, prelude::*, window::Window};

fn main() {
    let app = App::default();
    let mut win = Window::default().with_size(400, 400);
    let mut frame = Frame::default().with_label("hi").size_of(&win);

    //this line crashed in old versions (NULL-ptr deref inside FLTK)
    frame.set_label_type(LabelType::Multi);

    win.show();
    app.run().unwrap();
}
